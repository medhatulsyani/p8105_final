---
title: "Descriptive Analyses & Inferential Analyses"
author: ""
output: html_document
date: "2025-11-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(janitor)
library(plotly)
```

```{r}
## Importing the clean datasets

aed_inventory_df =
  read_csv("clean_data/aed_clean.csv")

leading_causes_clean =
  read_csv("clean_data/leading_causes_clean.csv")

traffic_volume_df =
  read_csv("clean_data/traffic_clean.csv")
```

## Descriptive Analyses

### AED counts and density by borough

### Mean and median traffic volume by borough and year

### Visualizations

## Inferential Analyses

### ANOVA for mean traffic volume across boroughs
```{r}
traffic_anova_model = aov(vol ~ boro, data = traffic_volume_df)
summary(traffic_anova_model)
```

At least one borough's mean traffic volume differs from the others. This is significant and there is extremely strong evidence since the F value is 1,094.

### ANOVA for mean AED across boroughs
```{r}
aed_anova_model = aov(aed_num_aeds ~ borough, data = aed_inventory_df)
summary(aed_anova_model)
```

At least one borough's mean AED differs from the others. This is significant with an F value of 24.09.

### Linear model for mean traffic volume across boroughs, set Manhattan as reference
```{r}
traffic_volume_df$boro = as.factor(traffic_volume_df$boro)
traffic_volume_df$boro = relevel(traffic_volume_df$boro, ref = "Manhattan")
traffic_anova_model = lm(vol ~ boro, data = traffic_volume_df)
summary(traffic_anova_model)
```

On average, every borough has less traffic volume when compared to that of Manhattan.
On average, Manhattan has 147.6 cars worth of traffic volume at a given intersection.
The mean traffic volume in The Bronx is 61.1 cars less than that of Manhattan.
The mean traffic volume in Brooklyn is 24.9 cars less than that of Manhattan.
The mean traffic volume in Queens is 29.8 cars less than that of Manhattan.
The mean traffic volume in Staten Island is 38.6 cars less than that of Manhattan.

### Linear model for mean AED across boroughs, set Manhattan as reference
```{r}
aed_inventory_df$borough = as.factor(aed_inventory_df$borough)
aed_inventory_df$borough = relevel(aed_inventory_df$borough, ref = "Manhattan")
aed_anova_model = lm(aed_num_aeds ~ borough, data = aed_inventory_df)
summary(aed_anova_model)
```

On average, every borough has less AED density when compared to that of Manhattan.
On average, the AED density in Manhattan is 1.795 AED access points per location.
The mean AED density in The Bronx is .75 less AED access points per location compared to that of Manhattan.
The mean AED density in Brooklyn is .69 less AED access points per location compared to that of Manhattan.
The mean AED density in Queens is .32 less AED access points per location compared to that of Manhattan.
The mean AED density in Staten Island is .57 less AED access points per location compared to that of Manhattan.

### Pearson correlation between AED density and mean traffic volume

```{r}
mean_traffic =
  traffic_volume_df %>% 
  group_by(boro) %>% 
  summarize(mean_traffic = mean(vol, na.rm = TRUE))

aed_density = aed_inventory_df %>%
  group_by(borough) %>%
  summarize(total_aeds = sum(aed_num_aeds, na.rm = TRUE))

aed_traffic = mean_traffic %>% 
  full_join(aed_density, by = c("boro" = "borough"))

cor_result =
  cor.test(aed_traffic$total_aeds, aed_traffic$mean_traffic)

print(cor_result)
```

The resulting Pearson correlation coefficient is 0.826. This indicates a strong positive correlation between AED density and traffic volume. Boroughs with higher mean traffic volume have more available AEDs, as seen by Manhattan having a mean traffic volume of 147.6 and 6583 AEDs while the Bronx has a mean traffic volume of 86.53 with only 1030 available AEDs, in comparison. However, the corresponding p-value for this correlation is > 0.05, indicating that the relationship is strong but not statistically significant at the 5% level.

### Derived metric
```{r}
traffic_summary = traffic_volume_df %>%
  group_by(boro) %>%
  summarize(total_vehicles = sum(vol, na.rm = TRUE))

aed_summary = aed_inventory_df %>%
  group_by(borough) %>%
  summarize(total_aeds = sum(aed_num_aeds, na.rm = TRUE))

tbr_df = traffic_summary %>%
  full_join(aed_summary, by = c("boro" = "borough"))

tbr_df = tbr_df %>%
  mutate(TBR = total_vehicles / total_aeds) %>%
  arrange(desc(TBR))

tbr_df
```

The Traffic Burden Ratio seems to be highest in Brooklyn and lowest in Manhattan. Although traffic is high in Manhattan, there is increased AED availability which mitigates the potential for a high TBR.